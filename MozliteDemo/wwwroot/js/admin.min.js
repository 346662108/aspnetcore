!function(t){var e={};function i(n){if(e[n])return e[n].exports;var r=e[n]={i:n,l:!1,exports:{}};return t[n].call(r.exports,r,r.exports,i),r.l=!0,r.exports}i.m=t,i.c=e,i.d=function(t,e,n){i.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},i.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},i.t=function(t,e){if(1&e&&(t=i(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(i.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var r in t)i.d(n,r,function(e){return t[e]}.bind(null,r));return n},i.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return i.d(e,"a",e),e},i.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},i.p="../",i(i.s=4)}({0:function(t,e){t.exports=jQuery},1:function(t,e){t.exports=Mozlite},12:function(t,e){},4:function(t,e,i){"use strict";(function(t,e){var n;function r(t,e){return t.replace(/\$(\d+)/gi,function(t,i){return 0==i||"0"==e||"1"==e?e:(e=+e,isNaN(e)?e:e.toFixed(i))})}function a(t,e){return t.replace(/\$([a-z0-9\\-]+)/gi,function(t,i){return e[i]})}function o(e){var i=t(".size-notify",e).sizeVal();t(".size-notify",e).sizeVal(i,function(t){return"("+t+")"});var n=t(".size-msg",e).sizeVal();t(".size-msg",e).sizeVal(n,function(t){return"("+t+")"});var r=t(".size-task",e).sizeVal();t(".size-task",e).sizeVal(r,function(t){return"("+t+")"}),t(".size-total").sizeVal(i+n+r)}i(12),window.$gets=function(e,i){var n=[];return t("["+e+"]",i).exec(function(t){var i=+t.attr(e);isNaN(i)||n.push(i)}),n},window.$bind=function(i){t("[v-prop]",i).exec(function(t){t.attr("v-id")||e.ajax("/data-apis/prop-vid",{id:t.attr("v-device"),prop:t.attr("v-prop")},function(e){return t.attr("v-id",e.id),!0})}),t("[v-propid]",i).exec(function(t){t.attr("v-id")||e.ajax("/data-apis/propid-vid",{id:t.attr("v-device"),propid:t.attr("v-propid")},function(e){return t.attr("v-id",e.id),!0})}),t("[v-mode]",i).exec(function(t){t.attr("v-id")||e.ajax("/data-apis/mode-vid",{id:t.attr("v-device"),mode:t.attr("v-mode")},function(e){return t.attr("v-id",e.id),!0})}),t("[vset-prop]",i).exec(function(t){t.attr("vset-id")||e.ajax("/data-apis/prop-vid",{id:t.attr("v-device"),prop:t.attr("vset-prop")},function(e){return t.attr("vset-id",e.id),!0})}),t("[vset-propid]",i).exec(function(t){t.attr("vset-id")||e.ajax("/data-apis/propid-vid",{id:t.attr("v-device"),propid:t.attr("vset-propid")},function(e){return t.attr("vset-id",e.id),!0})}),t("[vset-mode]",i).exec(function(t){t.attr("vset-id")||e.ajax("/data-apis/mode-vid",{id:t.attr("v-device"),mode:t.attr("vset-mode")},function(e){return t.attr("vset-id",e.id),!0})});var n=$gets("v-device",i);n.length>0&&e.ajax("/data-apis/mode-vids",{ids:n},function(e){for(var i in e)t("[v-device="+i+"]").attr("v-errid",e[i]);return!0});var r=$gets("v-bind",i);r.length&&e.ajax("/data-apis/variable-vid",{ids:r},function(e){return e.forEach(function(e){t("[v-bind="+e.id+"]",i).exec(function(t){for(var i in e)"id"!=i&&t.attr("v-data-"+i.toCamelCase(),e[i]);t.trigger("bind",e,t),window.d3&&window.d3.select(t[0]).dispatch("bind");var n=t.attr("v-bind-html");n&&t.html(a(n,e)),(n=t.attr("v-bind-text"))&&t.text(a(n,e))})}),!0})},t(function i(){var a=$gets("v-id"),o=$gets("v-errid"),d=a.concat(o);d.length?(d=d.distinct(),e.ajax("/data-apis/getvs",{ids:d},function(e){return e.forEach(function(e){-1!=a.indexOf(e.id)&&t("[v-id="+e.id+"]").exec(function(t){if(t.attr("v-value")!=e.value){t.attr("v-value",e.value),t.trigger("update",e,t),window.d3&&window.d3.select(t[0]).dispatch("update");var i=t.attr("v-html");i&&t.html(r(i,e.value)),(i=t.attr("v-text"))&&t.text(r(i,e.value))}}),-1!=o.indexOf(e.id)&&t("[v-errid="+e.id+"]").exec(function(t){var i=+t.attr("v-errval")||0,n=+e.value||0;if(i!=n){t.attr("v-errval",e.value);var r=0==n?"success":"error";t.trigger(r,e,t),window.d3&&window.d3.select(t[0]).dispatch(r)}})}),n&&clearTimeout(n),n=setTimeout(function(){i()},3e3),!0},function(t){n&&clearTimeout(n),n=setTimeout(function(){i()},3e3)})):(n&&clearTimeout(n),n=setTimeout(function(){i()},3e3))}),t.fn.sizeVal=function(e,i){return void 0===e?+this.attr("data-size")||0:this.each(function(){i=i?i(e):e;var n=t(this).attr("data-size",e).html(i);return e>0?n.show():n.hide(),n})},t.fn.sizeAdd=function(e,i){return e=e||1,this.each(function(){var n=t(this).sizeVal()+e;return n<0&&(n=0),t(this).sizeVal(n,i)})},e.queue(function(i){o(i),t("#notify",i).find("a.dropdown-panel-item").exec(function(n){n.on("click",function(r){return r.stopPropagation(),!!n.hasClass("notification-new")&&(e.ajax(n.attr("href"),n.jsAttrs("data"),function(e){return"success"==e.type&&(n.removeClass("notification-new").addClass("notification-confirmed"),t(".size-notify",i).sizeAdd(-1,function(t){return"("+t+")"}),o(i)),!0}),!1)})}),t("#notify",i).find(".dropdown-panel-action a").exec(function(n){n.on("click",function(r){return r.stopPropagation(),e.ajax(n.attr("href"),{},function(e){return"success"==e.type&&(t("#notify",i).find(".dropdown-panel-content").html(""),t(".size-notify",i).sizeVal(0),o(i)),!0}),!1})})}),window.$write=function(t,i,n){return t?void 0===i?(e.alert("写入值不能为空！"),!1):(e.ajax("/data-apis/write-vid",{id:t,value:i,priority:n||0},function(t){return"success"===t.type}),!0):(e.alert("变量不存在，变量id不能为空！"),!1)},t(function(){setTimeout($bind(),1e3)})}).call(this,i(0),i(1))}});